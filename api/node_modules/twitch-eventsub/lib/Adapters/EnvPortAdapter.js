"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.EnvPortAdapter = void 0;
var tslib_1 = require("tslib");
var twitch_common_1 = require("twitch-common");
var ReverseProxyAdapter_1 = require("./ReverseProxyAdapter");
/**
 * A connection adapter that reads the port to listen on from the environment.
 *
 * @hideProtected
 */
var EnvPortAdapter = /** @class */ (function (_super) {
    tslib_1.__extends(EnvPortAdapter, _super);
    /**
     * Creates a new environment port connection adapter.
     *
     * @expandParams
     *
     * @param options
     */
    function EnvPortAdapter(options) {
        var _this = this;
        var _a = options.variableName, variableName = _a === void 0 ? 'PORT' : _a, otherOptions = tslib_1.__rest(options, ["variableName"]);
        var port = Number(process.env[variableName || 'PORT']);
        if (Number.isNaN(port)) {
            throw new Error("The environment variable \"" + variableName + "\" does not contain a number");
        }
        _this = _super.call(this, tslib_1.__assign({ port: port }, otherOptions)) || this;
        return _this;
    }
    EnvPortAdapter = tslib_1.__decorate([
        twitch_common_1.rtfm('twitch-eventsub', 'EnvPortAdapter')
    ], EnvPortAdapter);
    return EnvPortAdapter;
}(ReverseProxyAdapter_1.ReverseProxyAdapter));
exports.EnvPortAdapter = EnvPortAdapter;
